---
title: Określenia optymalnej kombinacji rabatów nakładających się
description: Gdy rabaty się nakładają, należy określić taką kombinację nakładających się rabatów, która wygeneruje najniższą sumę transakcji lub najwyższy rabat końcowy. Gdy kwota rabatu różni się zależności od cen kupowanych produktów, taki jak w popularnym rabacie detalicznym „Kup 1, drugi dostaniesz X procent taniej” (BOGO), ten proces staje się zagadnieniem optymalizacji kombinatorycznej.
author: kfend
manager: AnnBe
ms.date: 06/20/2017
ms.topic: article
ms.prod: ''
ms.service: dynamics-365-retail
ms.technology: ''
ms.search.form: RetailParameters, RetailPeriodicDiscount,
audience: Application User, IT Pro
ms.reviewer: josaw
ms.search.scope: Core, Operations, Retail
ms.custom: 89643
ms.assetid: 09843c9a-3e19-4e4a-a8ce-80650f2095f9
ms.search.region: global
ms.search.industry: Retail
ms.author: kfend
ms.search.validFrom: 2016-05-31
ms.dyn365.ops.version: AX 7.0.1
ms.openlocfilehash: 565722da65cbb711acedb5acf7de4edfbd615314
ms.sourcegitcommit: 81a647904dd305c4be2e4b683689f128548a872d
ms.translationtype: HT
ms.contentlocale: pl-PL
ms.lasthandoff: 02/01/2020
ms.locfileid: "3023737"
---
# <a name="determine-the-optimal-combination-of-overlapping-discounts"></a><span data-ttu-id="a2882-104">Określenia optymalnej kombinacji rabatów nakładających się</span><span class="sxs-lookup"><span data-stu-id="a2882-104">Determine the optimal combination of overlapping discounts</span></span>

[!include [banner](includes/banner.md)]

<span data-ttu-id="a2882-105">Gdy rabaty się nakładają, należy określić taką kombinację nakładających się rabatów, która wygeneruje najniższą sumę transakcji lub najwyższy rabat końcowy.</span><span class="sxs-lookup"><span data-stu-id="a2882-105">When discounts overlap, you must determine the combination of overlapping discounts that will produce the lowest transaction total or the highest total discount.</span></span> <span data-ttu-id="a2882-106">Gdy kwota rabatu różni się zależności od cen kupowanych produktów, taki jak w popularnym rabacie detalicznym „Kup 1, drugi dostaniesz X procent taniej” (BOGO), ten proces staje się zagadnieniem optymalizacji kombinatorycznej.</span><span class="sxs-lookup"><span data-stu-id="a2882-106">When the discount amount varies according to the price of the products that are purchased, such as in the common "Buy 1, get 1 X percent off" (BOGO) retail discount, this process becomes an issue of combinatorial optimization.</span></span>

<span data-ttu-id="a2882-107">Ten artykuł dotyczy Microsoft Dynamics AX 2012 R3 z bazy wiedzy KB 3105973 (wersja z 2 listopada 2015 r.) lub nowszej, oraz Dynamics 365 Commerce.</span><span class="sxs-lookup"><span data-stu-id="a2882-107">This article applies to Microsoft Dynamics AX 2012 R3 with KB 3105973 (released November 2, 2015) or later, and to Dynamics 365 Commerce.</span></span> <span data-ttu-id="a2882-108">Aby umożliwić bezzwłoczne stosowanie kombinacji nakładających się rabatów, wprowadziliśmy metodę stosowania nakładających się rabatów.</span><span class="sxs-lookup"><span data-stu-id="a2882-108">To determine the combination overlapping discounts to apply in a timely manner, we have introduced a method for applying overlapping discounts.</span></span> <span data-ttu-id="a2882-109">Nazywamy tę nową metodę **rankingiem wartości krańcowej**.</span><span class="sxs-lookup"><span data-stu-id="a2882-109">We call this new method **marginal value ranking**.</span></span> <span data-ttu-id="a2882-110">Ranking wartości krańcowej jest stosowany w przypadku, gdy czas potrzebny do ocenienia możliwych kombinacji nakładających się rabatów przekracza próg skonfigurowany na stronie **Parametry komercyjne**.</span><span class="sxs-lookup"><span data-stu-id="a2882-110">Marginal value ranking is used when the time that is required in order to evaluate the possible combinations of overlapping discounts exceeds a threshold that is configurable on the **Commerce parameters** page.</span></span> <span data-ttu-id="a2882-111">W metodzie rankingu wartości krańcowej wartość jest obliczana dla każdego nakładającego się rabatu poprzez użycie wartość rabatu ze wspólnych produktów.</span><span class="sxs-lookup"><span data-stu-id="a2882-111">In the marginal value ranking method, a value is calculated for each overlapping discount by using the discount's value on the shared products.</span></span> <span data-ttu-id="a2882-112">Nakładające się rabaty są następnie stosowane w porządku od najwyższej wartości względnej do najniższej wartości względnej.</span><span class="sxs-lookup"><span data-stu-id="a2882-112">The overlapped discounts are then applied from the highest relative value to the lowest relative value.</span></span> <span data-ttu-id="a2882-113">Szczegółowe informacje na temat nowej metody zawiera sekcja „Wartość krańcowa” w dalszej części tego artykułu.</span><span class="sxs-lookup"><span data-stu-id="a2882-113">For details about the new method, see the "Marginal value" section, later in this article.</span></span> <span data-ttu-id="a2882-114">Ranking wartości krańcowej nie jest używany, gdy kwoty rabatów na produkt są całkowicie niezależne od innych produktów w transakcji.</span><span class="sxs-lookup"><span data-stu-id="a2882-114">Marginal value ranking isn't used when the discount amounts for a product aren't affected by another product in the transaction.</span></span> <span data-ttu-id="a2882-115">Na przykład ta metoda nie jest używana dla dwóch rabatów prostych ani dla rabatu prostego i rabatu ilościowego na jeden produkt.</span><span class="sxs-lookup"><span data-stu-id="a2882-115">For example, this method isn't used for two simple discounts, or for a simple discount and a single product quantity discount.</span></span>

## <a name="discount-examples"></a><span data-ttu-id="a2882-116">Przykłady rabatów</span><span class="sxs-lookup"><span data-stu-id="a2882-116">Discount examples</span></span>

<span data-ttu-id="a2882-117">Można utworzyć nieograniczoną liczbę rabatów dla wspólnego zestawu produktów.</span><span class="sxs-lookup"><span data-stu-id="a2882-117">You can create an unlimited number of discounts on a common set of products.</span></span> <span data-ttu-id="a2882-118">Jednakże ponieważ nie ma żadnego limitu, mogą wystąpić problemy z działaniem systemu podczas próby obliczania rabatów, które powinny być używane do różnych produktów.</span><span class="sxs-lookup"><span data-stu-id="a2882-118">However, because there is no limit, performance issues can occur when you try to calculate the discounts that should be used on the various products.</span></span> <span data-ttu-id="a2882-119">Poniższe przykłady ilustrują ten problem bardziej szczegółowo.</span><span class="sxs-lookup"><span data-stu-id="a2882-119">The following examples illustrate this issue in more detail.</span></span> <span data-ttu-id="a2882-120">W przykładzie 1 zaczynamy od dwóch produktów i dwóch nakładających się rabatów.</span><span class="sxs-lookup"><span data-stu-id="a2882-120">In example 1, we start with two products and two overlapping discounts.</span></span> <span data-ttu-id="a2882-121">Następnie w przykładzie 2 pokażemy, jak problem się rozwija wraz z dodawaniem kolejnych produktów.</span><span class="sxs-lookup"><span data-stu-id="a2882-121">Then, in example 2, we show how the issue evolves as more products are added.</span></span>

### <a name="example-1-two-products-and-two-discounts"></a><span data-ttu-id="a2882-122">Przykład 1: Dwa produkty i dwa rabaty</span><span class="sxs-lookup"><span data-stu-id="a2882-122">Example 1: Two products and two discounts</span></span>

<span data-ttu-id="a2882-123">W tym przykładzie są niezbędne dwa produkty, aby uzyskać każdy rabat, a rabaty nie mogą być łączone.</span><span class="sxs-lookup"><span data-stu-id="a2882-123">In this example, two products are required in order to qualify for each discount, and the discounts can't be combined.</span></span> <span data-ttu-id="a2882-124">Rabaty w tym przykładzie są typu **Najlepsza cena**.</span><span class="sxs-lookup"><span data-stu-id="a2882-124">The discounts in this example are **Best price** discounts.</span></span> <span data-ttu-id="a2882-125">Oba produkty kwalifikują się do obu rabatów.</span><span class="sxs-lookup"><span data-stu-id="a2882-125">Both products qualify for both discounts.</span></span> <span data-ttu-id="a2882-126">Poniżej przedstawiono oba rabaty.</span><span class="sxs-lookup"><span data-stu-id="a2882-126">Here are the two discounts.</span></span>

![Przykład dwóch rabatów z najlepszą ceną](./media/overlapping-discount-combo-01.jpg)

<span data-ttu-id="a2882-128">Dla dowolnych dwóch produktów to, który rabat jest lepszy, zależy od cen tych produktów.</span><span class="sxs-lookup"><span data-stu-id="a2882-128">For any two products, the better of these two discounts depends on the prices of the two products.</span></span> <span data-ttu-id="a2882-129">Jeżeli cena obu produktów jest równa bądź prawie równa, lepszy jest rabat 1.</span><span class="sxs-lookup"><span data-stu-id="a2882-129">When the price of both products is equal or almost equal, discount 1 is better.</span></span> <span data-ttu-id="a2882-130">Gdy cena jednego produktu jest znacznie niższa od ceny drugiego produktu, lepszy jest rabat 2.</span><span class="sxs-lookup"><span data-stu-id="a2882-130">When the price of one product is significantly less than the price of the other product, discount 2 is better.</span></span> <span data-ttu-id="a2882-131">Oto matematyczna reguła oceniania tych dwóch rabatów względem siebie.</span><span class="sxs-lookup"><span data-stu-id="a2882-131">Here is the mathematical rule for evaluating these two discounts against each other.</span></span>

![Reguła szacowania rabatów](./media/overlapping-discount-combo-02.jpg)

> [!NOTE]
> <span data-ttu-id="a2882-133">Gdy cena produktu 1 jest równa dwóm trzecim ceny produktu 2, rabaty są równe.</span><span class="sxs-lookup"><span data-stu-id="a2882-133">When the price of product 1 is equal to two-thirds of the price of product 2, the two discounts are equal.</span></span> <span data-ttu-id="a2882-134">W tym przykładzie efektywny procent rabatu 1 waha się od kilku procent (gdy ceny obu produktów są bardzo różne) do maksymalnie 25 procent (gdy dwa produkty mają taką samą cenę).</span><span class="sxs-lookup"><span data-stu-id="a2882-134">In this example, the effective discount percentage for discount 1 varies from a few percent (when the prices of the two products are far apart) to a maximum of 25 percent (when the two products have the same price).</span></span> <span data-ttu-id="a2882-135">Efektywny procent rabatu 2 jest stały.</span><span class="sxs-lookup"><span data-stu-id="a2882-135">The effective discount percentage for discount 2 is fixed.</span></span> <span data-ttu-id="a2882-136">Zawsze wynosi 20 procent.</span><span class="sxs-lookup"><span data-stu-id="a2882-136">It's always 20 percent.</span></span> <span data-ttu-id="a2882-137">Ponieważ efektywny procent rabatu 1 ma zakres, którego wartości mogą być wyższe lub niższe niż rabat 2, najlepszy rabat zależy od cen dwóch produktów, dla których ma zostać obliczony rabat.</span><span class="sxs-lookup"><span data-stu-id="a2882-137">Because the effective discount percentage for discount 1 has a range that can be more than or less than discount 2, the best discount depends on the prices of the two products that must be discounted.</span></span> <span data-ttu-id="a2882-138">W tym przykładzie obliczanie kończy się szybko, ponieważ są stosowane tylko dwa rabaty tylko do dwóch produktów.</span><span class="sxs-lookup"><span data-stu-id="a2882-138">In this example, the calculation is completed quickly, because only two discounts are applied on only two products.</span></span> <span data-ttu-id="a2882-139">Istnieją tylko dwie możliwe kombinacje: jedno zastosowanie rabatu 1 lub jedno zastosowanie rabatu 2.</span><span class="sxs-lookup"><span data-stu-id="a2882-139">There are only two possible combinations: one application of discount 1 or one application of discount 2.</span></span> <span data-ttu-id="a2882-140">Nie ma permutacji do obliczenia.</span><span class="sxs-lookup"><span data-stu-id="a2882-140">There are no permutations to calculate.</span></span> <span data-ttu-id="a2882-141">Wartość każdego rabatu jest obliczana przy użyciu obu produktów i jest stosowany najlepszych rabat.</span><span class="sxs-lookup"><span data-stu-id="a2882-141">The value of each discount is calculated by using both products, and the best discount is used.</span></span>

### <a name="example-2-four-products-and-two-discounts"></a><span data-ttu-id="a2882-142">Przykład 2: Cztery produkty i dwa rabaty</span><span class="sxs-lookup"><span data-stu-id="a2882-142">Example 2: Four products and two discounts</span></span>

<span data-ttu-id="a2882-143">Następnie użyjemy czterech produktów i tych samych dwóch rabatów.</span><span class="sxs-lookup"><span data-stu-id="a2882-143">Next, we will use four products and the same two discounts.</span></span> <span data-ttu-id="a2882-144">Wszystkie cztery produkty kwalifikują się do obu rabatów.</span><span class="sxs-lookup"><span data-stu-id="a2882-144">All four products qualify for both discounts.</span></span> <span data-ttu-id="a2882-145">Istnieje dwanaście możliwych kombinacji.</span><span class="sxs-lookup"><span data-stu-id="a2882-145">There are twelve possible combinations.</span></span> <span data-ttu-id="a2882-146">Na koniec do transakcji zostaną zastosowane dwa rabaty w jednej z trzech kombinacjach: dwa zastosowania rabatu 1, dwa zastosowania rabatu 2 lub jedno zastosowanie rabatu 1 i jedno zastosowanie rabatu 2.</span><span class="sxs-lookup"><span data-stu-id="a2882-146">In the end, two discounts will be applied to the transaction in one of three combinations: two applications of discount 1, two applications of discount 2, or one application of discount 1 and one application of discount 2.</span></span> <span data-ttu-id="a2882-147">Aby zilustrować możliwe kombinacje, przyjrzymy się dwóm różnym zestawom czterech produktów o różnych cenach:</span><span class="sxs-lookup"><span data-stu-id="a2882-147">To illustrate the possible combinations, we will look at two different sets of four products that have different prices:</span></span>

- <span data-ttu-id="a2882-148">Wszystkie cztery produkty mają taką samą cenę 15,00 USD.</span><span class="sxs-lookup"><span data-stu-id="a2882-148">All four products have the same price, $15.00.</span></span> <span data-ttu-id="a2882-149">W takim przypadku najlepszą kombinacją rabatu są dwa zastosowania rabatu 1.</span><span class="sxs-lookup"><span data-stu-id="a2882-149">In this case, the best discount combination is two applications of discount 1.</span></span> <span data-ttu-id="a2882-150">Dwa produkty będą miały pełną cenę, a dwa cenę z rabatem 50 procent.</span><span class="sxs-lookup"><span data-stu-id="a2882-150">Two products will be full price, and two will be 50 percent off.</span></span> <span data-ttu-id="a2882-151">Suma transakcji po rabacie wynosi 45 USD (15 + 15 + 7,50 + 7.50), czyli 15 USD (25 procent) mniej niż suma bez rabatu wynosząca 60 USD.</span><span class="sxs-lookup"><span data-stu-id="a2882-151">The discounted total for the transaction is $45 (15 + 15 + 7.50 + 7.50), which is $15 (25 percent) off the undiscounted total of $60.</span></span> <span data-ttu-id="a2882-152">Rabat 2 wynosi tylko 12 USD (20 procent).</span><span class="sxs-lookup"><span data-stu-id="a2882-152">Discount 2 is only $12 (20 percent).</span></span>
- <span data-ttu-id="a2882-153">Dwa produkty kosztują 20 USD każdy, jeden kosztuje 15 USD, a jeden 5 USD.</span><span class="sxs-lookup"><span data-stu-id="a2882-153">Two products are $20 each, one product is $15, and one product is $5.</span></span> <span data-ttu-id="a2882-154">W takim przypadku najlepszą kombinacją rabatów jest jedno zastosowanie rabatu 2 i jedno zastosowanie rabatu 1.</span><span class="sxs-lookup"><span data-stu-id="a2882-154">In this case, the best discount combination is one application of discount 2 and one application of discount 1.</span></span> <span data-ttu-id="a2882-155">Poniższe tabele ilustrują rabaty.</span><span class="sxs-lookup"><span data-stu-id="a2882-155">The following tables illustrates the discounts.</span></span>

<span data-ttu-id="a2882-156">Do odczytu tabel używaj jednego produktu z wiersza i jednego produktu z kolumny.</span><span class="sxs-lookup"><span data-stu-id="a2882-156">To read the tables, use one product from a row and one product from a column.</span></span> <span data-ttu-id="a2882-157">Na przykład w tabeli rabatu 1 w przypadku połączenia dwóch produktów kosztujących 20 USD otrzymasz rabat 10 USD.</span><span class="sxs-lookup"><span data-stu-id="a2882-157">For example, in the table for discount 1, when you combine the two $20 products, you get $10 off.</span></span> <span data-ttu-id="a2882-158">W tabeli rabatu 2 w przypadku połączenia produktów kosztujących 15 USD i 5 USD otrzymasz rabat 4 USD.</span><span class="sxs-lookup"><span data-stu-id="a2882-158">In the table for discount 2, when you combine the $15 product and the $5 product, you get $4 off.</span></span>

![Przykład użycia czterech produktów dla tych samych dwóch rabatów](./media/overlapping-discount-combo-03.jpg)

<span data-ttu-id="a2882-160">Najpierw znajdziemy największy rabat dostępny dla dowolnych dwóch produktów przy użyciu dowolnego rabatu.</span><span class="sxs-lookup"><span data-stu-id="a2882-160">First, we find the largest discount that is available from any two products by using either discount.</span></span> <span data-ttu-id="a2882-161">W dwóch tabelach przedstawiono kwotę rabatu dla wszystkich kombinacji dwóch produktów.</span><span class="sxs-lookup"><span data-stu-id="a2882-161">The two tables show the discount amount for all combinations of the two products.</span></span> <span data-ttu-id="a2882-162">Zacieniowane fragmenty tabel reprezentują przypadki, gdy produkt jest sparowany z samym sobą, czego nie można zrobić, lub odwrotne sparowanie dwóch produktów, które daje taką samą kwotę rabatu i może zostać zignorowane.</span><span class="sxs-lookup"><span data-stu-id="a2882-162">The shaded portions of the tables represent either cases where a product is paired with itself, which we can't do, or a reverse pairing of two products that produces the same discount amount and can be ignored.</span></span> <span data-ttu-id="a2882-163">Patrząc na tabele, można zobaczyć, że rabat 1 na dwa towary za 20 USD jest największym rabatem dostępnym wśród obu typów rabatu dla wszystkich czterech produktów.</span><span class="sxs-lookup"><span data-stu-id="a2882-163">By looking at the tables, you can see that discount 1 for the two $20 items is the largest discount that is available for either discount on all four products.</span></span> <span data-ttu-id="a2882-164">(Ten rabat jest wyróżniony na zielono w pierwszej tabeli). To pozostawia tylko produkty za 15 USD i 5 USD.</span><span class="sxs-lookup"><span data-stu-id="a2882-164">(This discount is highlighted in green in the first table.) That leaves only the $15 product and the $5 product.</span></span> <span data-ttu-id="a2882-165">Patrząc na dwie tabele ponownie, można zobaczyć, że dla tych dwóch produktów rabat 1 daje kwotę rabatu 2,50 USD, podczas gdy rabat 2 daje kwotę rabatu 4 USD.</span><span class="sxs-lookup"><span data-stu-id="a2882-165">By looking at the two tables again, you can see that, for these two products, discount 1 gives a $2.50 discount, whereas discount 2 gives a $4 discount.</span></span> <span data-ttu-id="a2882-166">W związku z tym wybieramy rabat 2.</span><span class="sxs-lookup"><span data-stu-id="a2882-166">Therefore, we select discount 2.</span></span> <span data-ttu-id="a2882-167">Rabat końcowy wynosi 14 USD.</span><span class="sxs-lookup"><span data-stu-id="a2882-167">The total discount is $14.</span></span> <span data-ttu-id="a2882-168">Aby ułatwić wizualizację tej dyskusji, zamieszczamy dwie dodatkowe tabele, które pokazują efektywny procent rabatu dla wszystkich możliwych kombinacji dwóch produktów dla rabatów typu 1 i 2.</span><span class="sxs-lookup"><span data-stu-id="a2882-168">To make this discussion easier to visualize, here are two additional tables that show the effective discount percentage for all possible two-product combinations for both discount 1 and discount 2.</span></span> <span data-ttu-id="a2882-169">Pokazujemy tylko połowę listy kombinacji, ponieważ kolejność stosowania obu rabatów do tych dwóch produktów nie ma znaczenia.</span><span class="sxs-lookup"><span data-stu-id="a2882-169">Only half the list of combinations is included, because, for these two discounts, the order in which the two products are put into the discount doesn't matter.</span></span> <span data-ttu-id="a2882-170">Najwyższy efektywny rabat (25 procent) jest wyróżniony na zielono, a najniższy efektywny rabat (10 procent) jest wyróżniony kolorem czerwonym.</span><span class="sxs-lookup"><span data-stu-id="a2882-170">The highest effective discount (25 percent) is highlighted in green, and the lowest effective discount (10 percent) is highlighted in red.</span></span>

![Efektywna wartość procentowa rabatu dla wszystkich kombinacji dwóch produktów z tytułu obu rabatów](./media/overlapping-discount-combo-04.jpg)

> [!NOTE]
> <span data-ttu-id="a2882-172">Gdy ceny się różnią, a dwa lub więcej rabatów konkurują ze sobą, jedynym sposobem zagwarantowania sobie najlepszej kombinacji rabatów jest ocena obu rabatów i ich porównanie.</span><span class="sxs-lookup"><span data-stu-id="a2882-172">When prices vary, and two or more discount compete, the only way to guarantee the best combination of discounts is to evaluate both discounts and compare them.</span></span>

## <a name="total-possible-combinations"></a><span data-ttu-id="a2882-173">Łączna liczba możliwych kombinacji</span><span class="sxs-lookup"><span data-stu-id="a2882-173">Total possible combinations</span></span>

<span data-ttu-id="a2882-174">W tej sekcji kontynuujemy przykład z poprzedniej sekcji.</span><span class="sxs-lookup"><span data-stu-id="a2882-174">This section continues the example from the previous section.</span></span> <span data-ttu-id="a2882-175">Dodamy więcej produktów i kolejny rabat i zobaczymy, ile kombinacji trzeba obliczyć i porównać.</span><span class="sxs-lookup"><span data-stu-id="a2882-175">We will add more products and another discount, and see how many combinations must be calculated and compared.</span></span> <span data-ttu-id="a2882-176">Poniższa tabela pokazuje liczbę możliwych kombinacji rabatów wraz ze wzrostem liczby produktów.</span><span class="sxs-lookup"><span data-stu-id="a2882-176">The following table shows the number of possible discount combinations as the product quantity increases.</span></span> <span data-ttu-id="a2882-177">W tabeli przedstawiono, co się dzieje, gdy istnieją dwa nakładające się rabaty, jak w poprzednim przykładzie, i gdy istnieją trzy nakładające się rabaty.</span><span class="sxs-lookup"><span data-stu-id="a2882-177">The table shows what happens both when there are two overlapping discounts, as in the previous example, and when there are three overlapping discounts.</span></span> <span data-ttu-id="a2882-178">Liczba możliwych kombinacji rabatów, które muszą zostać ocenione, wkrótce przekracza zdolności szybkiego komputera do obliczenia i porównania w tempie akceptowanym w transakcjach detalicznych.</span><span class="sxs-lookup"><span data-stu-id="a2882-178">The number of possible discount combinations that must be evaluated soon exceeds what even a fast computer can calculate and compare quickly enough to be acceptable for retail transactions.</span></span>

![Liczba możliwych kombinacji rabatów wraz ze wzrostem liczby produktów](./media/overlapping-discount-combo-05.jpg)

<span data-ttu-id="a2882-180">W przypadku jeszcze większej liczby produktów i nakładających się rabatów całkowita liczba możliwych kombinacji rabatów szybko sięga milionów i czas niezbędny do oceny i wybrania najlepszej kombinacji szybko staje się zauważalny.</span><span class="sxs-lookup"><span data-stu-id="a2882-180">When even larger quantities or more overlapping discounts are applied, the total number of possible discount combinations quickly goes into the millions, and the time that is required in order to evaluate and select the best possible combination quickly becomes noticeable.</span></span> <span data-ttu-id="a2882-181">Dlatego w aparacie ustalania cen wprowadzono pewne optymalizacje, które zmniejszają łączną liczbę kombinacji wymagających oceny.</span><span class="sxs-lookup"><span data-stu-id="a2882-181">Some optimizations have been done in the price engine to reduce the total number of combinations that must be evaluated.</span></span> <span data-ttu-id="a2882-182">Jednak ponieważ liczba nakładających się rabatów i ilości produktów w transakcjach są nieograniczone, zawsze trzeba oceniać dużą liczbę kombinacji, gdy tylko istnieją nakładające się rabaty.</span><span class="sxs-lookup"><span data-stu-id="a2882-182">However, because the number overlapping discounts and the quantities in a transaction aren't limited, a large number of combinations will always have to be evaluated whenever there are overlapping discounts.</span></span> <span data-ttu-id="a2882-183">W celu rozwiązania tego problemu wprowadzono metodę rankingu wartości krańcowej.</span><span class="sxs-lookup"><span data-stu-id="a2882-183">This issue is the issue that the marginal value ranking method addresses.</span></span>

## <a name="marginal-value-method"></a><span data-ttu-id="a2882-184">Metoda wartości krańcowej</span><span class="sxs-lookup"><span data-stu-id="a2882-184">Marginal value method</span></span>

<span data-ttu-id="a2882-185">Aby rozwiązać problem lawinowo wzrastającej liczby kombinacji wymagających oceny, wprowadzono optymalizację, która oblicza wartość dla każdego wspólnego produktu w każdym rabacie w zbiorze produktów, do którego można zastosować dwa lub więcej rabatów.</span><span class="sxs-lookup"><span data-stu-id="a2882-185">To resolve the issue of an exponentially increasing number of combinations that must be evaluated, an optimization exists that calculates the value per shared product of each discount on the set of products that two or more discounts can be applied to.</span></span> <span data-ttu-id="a2882-186">Nazywamy tę wartość **wartością krańcową** rabatu na wspólne produkty.</span><span class="sxs-lookup"><span data-stu-id="a2882-186">We refer to this value as the **marginal value** of the discount for the shared products.</span></span> <span data-ttu-id="a2882-187">Wartość krańcowa jest średnim wzrostem łącznej kwoty rabatu na każdy produkt, gdy w każdym rabacie występują wspólne produkty.</span><span class="sxs-lookup"><span data-stu-id="a2882-187">The marginal value is the average per product increase in the total discount amount when the shared products are included in each discount.</span></span> <span data-ttu-id="a2882-188">Wartość krańcowa jest obliczana następująco: od łącznej kwoty rabatu (DTotal) jest odejmowana kwota rabatu bez wspólnych produktów (DMinus\\ Shared), a uzyskana różnica jest dzielona przez liczbę wspólnych produktów (ProductsShared).</span><span class="sxs-lookup"><span data-stu-id="a2882-188">The marginal value is calculated by taking the total discount amount (DTotal), subtracting the discount amount without the shared products (DMinus\\ Shared), and dividing that difference by the number of shared products (ProductsShared).</span></span>

![Formuła obliczania wartości krańcowej](./media/overlapping-discount-combo-06.jpg)

<span data-ttu-id="a2882-190">Po obliczeniu wartości krańcowej każdego rabatu dla zbioru wspólnych produktów rabaty są stosowane do wspólnych produktów kolejno od najwyższej wartości krańcowej do najniższej wartości krańcowej.</span><span class="sxs-lookup"><span data-stu-id="a2882-190">After the marginal value of each discount on a shared set of products is calculated, the discounts are applied to the shared products in order, exhaustively, from highest marginal value to lowest marginal value.</span></span> <span data-ttu-id="a2882-191">W przypadku tej metody wszystkie pozostałe możliwości rabatów nie są porównywane przy każdym stosowaniu jednego wystąpienia rabatu.</span><span class="sxs-lookup"><span data-stu-id="a2882-191">For this method, all remaining discount possibilities aren't compared every time after a single instance of a discount is applied.</span></span> <span data-ttu-id="a2882-192">Zamiast tego nakładające się rabaty są porównywane jeden raz, a następnie stosowane kolejno.</span><span class="sxs-lookup"><span data-stu-id="a2882-192">Instead, the overlapping discounts are compared one time and then applied in order.</span></span> <span data-ttu-id="a2882-193">Nie są wykonywane żadne inne porównania.</span><span class="sxs-lookup"><span data-stu-id="a2882-193">No additional comparisons are done.</span></span> <span data-ttu-id="a2882-194">Na stronie **Parametry sprzedaży** na karcie **Rabat** można skonfigurować próg przełączania na metodę wartości krańcowej.</span><span class="sxs-lookup"><span data-stu-id="a2882-194">You can configure the threshold to switch to the marginal value method on the **Discount** tab of the **Commerce parameters** page.</span></span> <span data-ttu-id="a2882-195">Dopuszczalny czas na obliczenie rabatu końcowego różni się w poszczególnych branżach wykorzystujących sprzedaż detaliczną.</span><span class="sxs-lookup"><span data-stu-id="a2882-195">The acceptable time to calculate the total discount varies across retail industries.</span></span> <span data-ttu-id="a2882-196">Jednakże zasadniczo wynosi on od kilkudziesięciu milisekund do jednej sekundy.</span><span class="sxs-lookup"><span data-stu-id="a2882-196">However, this time generally falls in the range of tens of milliseconds to one second.</span></span>
