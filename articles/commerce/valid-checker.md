---
title: Sprawdzanie spójności transakcji sprzedaży detalicznej
description: W tym temacie opisano funkcje sprawdzania spójności transakcji w rozwiązaniu Dynamics 365 Commerce.
author: josaw1
manager: AnnBe
ms.date: 10/14/2019
ms.topic: index-page
ms.prod: ''
ms.service: dynamics-365-retail
ms.technology: ''
audience: Application User
ms.reviewer: josaw
ms.search.scope: Core, Operations, Retail
ms.custom: ''
ms.assetid: ed0f77f7-3609-4330-bebd-ca3134575216
ms.search.region: global
ms.search.industry: Retail
ms.author: josaw
ms.search.validFrom: 2019-01-15
ms.dyn365.ops.version: 10
ms.openlocfilehash: eb5c7389ba29d50232f9321e40bccceecd5f5fc6
ms.sourcegitcommit: 02640a0f63daa9e509146641824ed623c4d69c7f
ms.translationtype: HT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/16/2020
ms.locfileid: "3265625"
---
# <a name="retail-transaction-consistency-checker"></a><span data-ttu-id="5e193-103">Sprawdzanie spójności transakcji sprzedaży detalicznej</span><span class="sxs-lookup"><span data-stu-id="5e193-103">Retail transaction consistency checker</span></span>

[!include [banner](includes/banner.md)]

<span data-ttu-id="5e193-104">W tym temacie opisano funkcje sprawdzania spójności transakcji w rozwiązaniu Microsoft Dynamics 365 Commerce.</span><span class="sxs-lookup"><span data-stu-id="5e193-104">This topic describes the transaction consistency checker functionality in Microsoft Dynamics 365 Commerce.</span></span> <span data-ttu-id="5e193-105">Moduł sprawdzania spójności umożliwia identyfikowanie i izolowanie niespójnych transakcji przed pobraniem ich przez proces księgowania zestawienia.</span><span class="sxs-lookup"><span data-stu-id="5e193-105">The consistency checker identifies and isolates inconsistent transactions before they are picked up by the statement posting process.</span></span>

<span data-ttu-id="5e193-106">Gdy zestawienie jest księgowane, księgowanie może zakończyć się niepowodzeniem z powodu niespójności danych w tabelach transakcji handlowych.</span><span class="sxs-lookup"><span data-stu-id="5e193-106">When a statement is posted, posting can fail due to inconsistent data in the commerce transaction tables.</span></span> <span data-ttu-id="5e193-107">Przyczyną tego problemu z danymi mogą być nieprzewidziane problemy w aplikacji punktu sprzedaży (POS) lub nieprawidłowy import transakcji z systemów POS innych firm.</span><span class="sxs-lookup"><span data-stu-id="5e193-107">The data issue may be caused by unforeseen issues in the point of sale (POS) application, or if transactions were incorrectly imported from third-party POS systems.</span></span> <span data-ttu-id="5e193-108">Przykłady wyświetlania tych niespójności:</span><span class="sxs-lookup"><span data-stu-id="5e193-108">Examples of how these inconsistencies may appear include:</span></span> 

- <span data-ttu-id="5e193-109">Suma transakcji w tabeli nagłówka jest niezgodna z łączną wartością transakcji w wierszach.</span><span class="sxs-lookup"><span data-stu-id="5e193-109">The transaction total on the header table does not match the transaction total on the lines.</span></span>
- <span data-ttu-id="5e193-110">Liczba wierszy w tabeli nagłówka jest niezgodna z liczbą wierszy w tabeli transakcji.</span><span class="sxs-lookup"><span data-stu-id="5e193-110">The line count on the header table does not match with the number of lines in the transaction table.</span></span>
- <span data-ttu-id="5e193-111">Podatki w tabeli nagłówka są niezgodne z kwotą podatku w wierszach.</span><span class="sxs-lookup"><span data-stu-id="5e193-111">Taxes on the header table do not match the tax amount on the lines.</span></span> 

<span data-ttu-id="5e193-112">Kiedy niezgodne transakcje są pobierane przez proces księgowania zestawienia, powstają niespójne faktury sprzedaży i dzienniki płatności i w efekcie cały proces księgowania zestawienia kończy się niepowodzeniem.</span><span class="sxs-lookup"><span data-stu-id="5e193-112">When inconsistent transactions are picked up by the statement posting process, inconsistent sales invoices and payment journals are created, and the entire statement posting process fails as a result.</span></span> <span data-ttu-id="5e193-113">Odzyskiwanie zestawień w tym stanie wymaga skomplikowanych poprawek danych w wielu tabelach transakcji.</span><span class="sxs-lookup"><span data-stu-id="5e193-113">Recovering the statements from such a state involves complex data fixes across multiple transaction tables.</span></span> <span data-ttu-id="5e193-114">Kontroler spójności transakcji zapobiega takim problemom.</span><span class="sxs-lookup"><span data-stu-id="5e193-114">The transaction consistency checker prevents such issues.</span></span>

<span data-ttu-id="5e193-115">Wykres poniżej pokazuje proces księgowania z kontrolerem spójności transakcji.</span><span class="sxs-lookup"><span data-stu-id="5e193-115">The following chart illustrates the posting process with the transaction consistency checker.</span></span>

<span data-ttu-id="5e193-116">![Proces księgowania zestawienia z modułem sprawdzania spójności transakcji](./media/validchecker.png "Proces księgowania zestawienia z modułem sprawdzania spójności transakcji")</span><span class="sxs-lookup"><span data-stu-id="5e193-116">![Statement posting process with transaction consistency checker](./media/validchecker.png "Statement posting process with retail transaction consistency checker")</span></span>

<span data-ttu-id="5e193-117">Proces wsadowy **Sprawdź poprawność transakcji w sklepie** sprawdza spójność tabel transakcji handlowych w następujących scenariuszach.</span><span class="sxs-lookup"><span data-stu-id="5e193-117">The **Validate store transactions** batch process checks the consistency of the commerce transaction tables for the following scenarios.</span></span>

- <span data-ttu-id="5e193-118">**Konto odbiorcy** — sprawdza, czy konto odbiorcy w tabelach transakcji istnieje w danych głównych odbiorcy w centrali.</span><span class="sxs-lookup"><span data-stu-id="5e193-118">**Customer account** – Validates that the customer account in the transaction tables exists in the HQ customer master.</span></span>
- <span data-ttu-id="5e193-119">**Liczba wierszy** — sprawdza, czy liczba wierszy w tabeli nagłówka transakcji jest zgodna z liczbą wierszy w tabelach transakcji sprzedaży.</span><span class="sxs-lookup"><span data-stu-id="5e193-119">**Line count** – Validates that the number of lines, as captured on the transaction header table, matches the number of lines in the sales transaction tables.</span></span>
- <span data-ttu-id="5e193-120">**Cena zawiera podatek** — sprawdza, czy parametr **Cena zawiera podatek** jest spójny w wierszach transakcji.</span><span class="sxs-lookup"><span data-stu-id="5e193-120">**Price includes tax** – Validates that the **Price includes tax** parameter is consistent across transaction lines.</span></span>
- <span data-ttu-id="5e193-121">**Kwota płatności** — sprawdza, czy rekordy płatności pasują do kwoty płatności w nagłówku.</span><span class="sxs-lookup"><span data-stu-id="5e193-121">**Payment amount** - Validates that the payment records match the payment amount on header.</span></span>
- <span data-ttu-id="5e193-122">**Kwota brutto** — sprawdza, czy kwota brutto w nagłówku jest sumą kwot netto w wierszach i kwoty podatku.</span><span class="sxs-lookup"><span data-stu-id="5e193-122">**Gross amount** – Validates that the gross amount on the header is the sum of the net amounts on the lines plus the tax amount.</span></span>
- <span data-ttu-id="5e193-123">**Kwota netto** — sprawdza, czy kwota netto w nagłówku jest sumą kwot netto w wierszach.</span><span class="sxs-lookup"><span data-stu-id="5e193-123">**Net amount** – Validates that the net amount on the header is the sum of the net amounts on the lines.</span></span>
- <span data-ttu-id="5e193-124">**Niedopłata/Nadpłata** — sprawdza, czy różnica między kwotą brutto w nagłówku a kwotą płatności nie przekracza maksymalnej skonfigurowanej niedopłaty/nadpłaty.</span><span class="sxs-lookup"><span data-stu-id="5e193-124">**Under / Over payment** – Validates that the difference between the gross amount on the header and the payment amount doesn't exceed the maximum underpayment/overpayment configuration.</span></span>
- <span data-ttu-id="5e193-125">**Kwota rabatu** — sprawdza, czy kwota rabatu w tabelach rabatów i kwota rabatu w tabelach wierszy transakcji są spójne i czy kwota rabatu w nagłówku jest sumą kwot rabatów w wierszach.</span><span class="sxs-lookup"><span data-stu-id="5e193-125">**Discount amount** – Validates that the discount amount on the discount tables and the discount amount on the transaction line tables are consistent, and that the discount amount on the header is the sum of the discount amounts on the lines.</span></span>
- <span data-ttu-id="5e193-126">**Rabat wiersza** — sprawdza, czy rabat wiersza w wierszu transakcji jest sumą wszystkich wierszy w tabeli rabatów, które odpowiadają wierszowi transakcji.</span><span class="sxs-lookup"><span data-stu-id="5e193-126">**Line discount** – Validates that the line discount on the transaction line is the sum of all the lines in the discount table that corresponds to the transaction line.</span></span>
- <span data-ttu-id="5e193-127">**Pozycja na kartę upominkową** — rozwiązanie Commerce nie obsługuje zwrotów pozycji przekazanych za pośrednictwem karty upominkowej.</span><span class="sxs-lookup"><span data-stu-id="5e193-127">**Gift card item** – Commerce doesn't support the return of gift card items.</span></span> <span data-ttu-id="5e193-128">Można jednak wypłacić saldo karty upominkowej. Każda pozycja na karcie upominkowej, który jest przetwarzana jako wiersz zwrotu, a nie wiersz wypłaty, powoduje niepowodzenie wykonywania procesu księgowania zestawienia.</span><span class="sxs-lookup"><span data-stu-id="5e193-128">However, the balance on a gift card can be cashed out. Any gift card item that is processed as a return line instead of a cash-out line fails the statement posting process.</span></span> <span data-ttu-id="5e193-129">Proces weryfikacji pozycji przekazanych za pośrednictwem karty upominkowej pomaga zagwarantować, że w tabelach transakcji będą istnieć tylko wiersze wypłat kart upominkowych.</span><span class="sxs-lookup"><span data-stu-id="5e193-129">The validation process for gift card items helps guarantee that the only return gift card line items on the transaction tables are gift card cash-out lines.</span></span>
- <span data-ttu-id="5e193-130">**Cena ujemna** — sprawdza, czy nie występują wiersze transakcji z ujemną ceną.</span><span class="sxs-lookup"><span data-stu-id="5e193-130">**Negative price** – Validates that there are no negative price transaction lines.</span></span>
- <span data-ttu-id="5e193-131">**Towar i wariant** — sprawdza, czy towary i warianty wymienione w wierszach transakcji istnieją w pliku głównym towarów i wariantów.</span><span class="sxs-lookup"><span data-stu-id="5e193-131">**Item & Variant** – Validates that items and variants on the transaction lines exist in the item and variant master file.</span></span>
- <span data-ttu-id="5e193-132">**Kwota podatku** — sprawdza, czy rekordy podatku pasują do kwot podatku w wierszach.</span><span class="sxs-lookup"><span data-stu-id="5e193-132">**Tax amount** - Validates that tax records match the tax amounts on the lines.</span></span>
- <span data-ttu-id="5e193-133">**Numer seryjny** — sprawdza, czy wiersze transakcji dla pozycji kontrolowanych przez numer seryjny zawierają numer seryjny.</span><span class="sxs-lookup"><span data-stu-id="5e193-133">**Serial number** - Validates that the serial number is present in the transaction lines for items that are controlled by serial number.</span></span>
- <span data-ttu-id="5e193-134">**Znak** — sprawdza, czy znak na ilości i kwocie netto jest taki sam we wszystkich wierszach transakcji.</span><span class="sxs-lookup"><span data-stu-id="5e193-134">**Sign** - Validates that the sign on the quantity and the net amount are the same in all the transaction lines.</span></span>
- <span data-ttu-id="5e193-135">**Data biznesowa** — sprawdza, czy okresy obrachunkowe są otwarte dla wszystkich dat biznesowych dla transakcji.</span><span class="sxs-lookup"><span data-stu-id="5e193-135">**Business date** - Validates that the financial periods for all the business dates for the transactions are open.</span></span>

## <a name="set-up-the-consistency-checker"></a><span data-ttu-id="5e193-136">Konfigurowanie modułu sprawdzania spójności</span><span class="sxs-lookup"><span data-stu-id="5e193-136">Set up the consistency checker</span></span>

<span data-ttu-id="5e193-137">Skonfiguruj cykliczne uruchamianie procesu wsadowego „Sprawdź poprawność transakcji w sklepie” w obszarze **Retail i Commerce \> Retail i Commerce — składniki IT \> Księgowanie w punkcie sprzedaży**.</span><span class="sxs-lookup"><span data-stu-id="5e193-137">Configure the "Validate store transactions" batch process, at **Retail and Commerce \> Retail and Commerce IT \> POS posting**, for periodic runs.</span></span> <span data-ttu-id="5e193-138">Zadanie wsadowe można zaplanować według hierarchii organizacyjnej sklepu w sposób podobny do tego, w jaki skonfigurowane są procesy „Oblicz zestawienie w trybie wsadowym” i „Księgowanie zestawienia w trybie wsadowym”.</span><span class="sxs-lookup"><span data-stu-id="5e193-138">The batch job can be scheduled based on store organization hierarchy, similar to how the "Calculate statement in batch" and "Post statement in batch" processes are set up.</span></span> <span data-ttu-id="5e193-139">Zalecamy skonfigurowanie tego procesu w taki sposób, aby uruchamiał się wiele razy w ciągu dnia i każdorazowo po wykonaniu zadania ściągania.</span><span class="sxs-lookup"><span data-stu-id="5e193-139">We recommend that you configure this batch process to run multiple times in a day and schedule it so that it runs at the end of every P-job execution.</span></span>

## <a name="results-of-validation-process"></a><span data-ttu-id="5e193-140">Wyniki procesu sprawdzania</span><span class="sxs-lookup"><span data-stu-id="5e193-140">Results of validation process</span></span>

<span data-ttu-id="5e193-141">Wyniki sprawdzania przez proces wsadowy są zaznaczone na odpowiedniej transakcji.</span><span class="sxs-lookup"><span data-stu-id="5e193-141">The results of the validation check by the batch process are tagged on the appropriate transaction.</span></span> <span data-ttu-id="5e193-142">Pole **Stan weryfikacji** w rekordzie transakcji ma wartość **Powodzenie** lub **Błąd**, a data ostatniej weryfikacji znajduje się w polu **Godzina ostatniej weryfikacji**.</span><span class="sxs-lookup"><span data-stu-id="5e193-142">The **Validation status** field on the transaction record is either set to **Successful** or **Error**, and the date of the last validation run appears on the **Last validation time** field.</span></span>

<span data-ttu-id="5e193-143">Aby wyświetlić dłuższy opis błędu sprawdzania poprawności, zaznacz odpowiedni rekord transakcji sklepu i kliknij przycisk **Błędy weryfikacji**.</span><span class="sxs-lookup"><span data-stu-id="5e193-143">To view more descriptive error text relating to a validation failure, select the relevant store transaction record and click the **Validation errors** button.</span></span>

<span data-ttu-id="5e193-144">Transakcje, które nie przeszły weryfikacji, oraz transakcji, które nie zostały jeszcze zweryfikowane, nie będą pobierane do zestawień.</span><span class="sxs-lookup"><span data-stu-id="5e193-144">Transactions that fail the validation check and transactions that have not yet been validated will not be pulled into statements.</span></span> <span data-ttu-id="5e193-145">W trakcie procesu „Oblicz zestawienie” użytkownicy otrzymają powiadomienie, że istnieją transakcje, które mogły zostać uwzględnione w zestawieniu, ale tak się nie stało.</span><span class="sxs-lookup"><span data-stu-id="5e193-145">During the "Calculate statement" process, users will be notified if there are transactions that could have been included in the statement but weren't.</span></span>

<span data-ttu-id="5e193-146">W przypadku wystąpienia błędu weryfikacji można wyeliminować tylko po skontaktowaniu się z Pomocą techniczną firmy Microsoft.</span><span class="sxs-lookup"><span data-stu-id="5e193-146">If a validation error is found, the only way to fix the error is to contact Microsoft Support.</span></span> <span data-ttu-id="5e193-147">W przyszłej wersji zostanie dodana funkcja pozwalająca użytkownikom naprawiać rekordy z błędami za pomocą interfejsu.</span><span class="sxs-lookup"><span data-stu-id="5e193-147">In a future release, capability will be added so that users can fix the records that failed through the user interface.</span></span> <span data-ttu-id="5e193-148">Zostaną również dodane funkcje rejestrowania i inspekcji pozwalające śledzić historię modyfikacji.</span><span class="sxs-lookup"><span data-stu-id="5e193-148">Logging and auditing capabilities will also be made available to trace the history of the modifications.</span></span>

> [!NOTE]
> <span data-ttu-id="5e193-149">Oprócz tego w przyszłej wersji pojawią się też dodatkowe reguły weryfikacji dostosowane do innych scenariuszy.</span><span class="sxs-lookup"><span data-stu-id="5e193-149">Additional validation rules to support more scenarios will be added in a future release.</span></span>
